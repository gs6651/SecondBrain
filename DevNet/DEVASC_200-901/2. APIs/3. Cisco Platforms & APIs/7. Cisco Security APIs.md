
# Cisco Security APIs

Most Cisco security products provide APIs to enable users to enhance the provided functionality or embed the products into larger automated solutions, reducing the need for manual actions.

Security use cases using various security products:

- Cisco Firepower for firewalling
- Cisco Umbrella for endpoint protection
- Cisco AMP for endpoint protection
- Cisco Threat Grid for threat intelligence

## Cisco Firepower

There are three Cisco Firepower devices that provide an API:

- **Cisco FTD:** A Rest API that automates configuration management and execution of operational tasks on FTD devices.
- **Cisco FMC:** Context-rich APIs for exchange of network and endpoint security event data and host information.
- **FXOS Firepower Chassis Manager:** REST API for the Firepower 9300 Chassis. It includes both configuration and monitoring APIs for platform and Firepower chassis services.

Cisco FTD API Use Cases
You can use the Cisco FTD API to perform these tasks:

- Configure policy and settings:
  - Manage policy objects
  - Manage firewall policy
  - Manage device settings

- Configure logging and cloud integrations:
  - Configure syslog logging (IPS, file/malware, connection)
  - Configure connections to the cloud
  - Configure smart licensing

- Automate your device configuration:
  - Ansible automation
  - Python or programming language of your choice
  - Industry-standard OAuth authentication

## Cisco FTD API

The following figure illustrates the structure of a REST call toward Cisco FTD.

![alt text](/DevNet/DEVASC_200-901/Images/image-2370.png)

Cisco FTD has a REST explorer to help you identify the proper REST syntax.

## Cisco Umbrella REST API

The Cisco Umbrella Enforcement API is designed to give technology partners the ability to send security events from their platform, service, or appliance within a mutual customer environment to the Umbrella cloud for enforcement. You may also list the domains and delete individual domains from the list. All received events will be segmented by the mutual customer and used for future enforcement.

To successfully integrate, you must format your events to meet the public format. This API is a REST API and follows RESTful principles in implementation.

The API is restricted to HTTPS and is hosted and available to make requests at  `https://s-platform.api.opendns.com`.

All responses are served as JSON and authentication is required for all requests. The API makes extensive use of query strings to retrieve and filter resources.

![alt text](/DevNet/DEVASC_200-901/Images/image-2371.png)

## Umbrella REST API Example

To gather the lists of domains already added to the shared customer domain list, run a GET request against the domains endpoint of the API.

![alt text](/DevNet/DEVASC_200-901/Images/image-2372.png)

The reply is provided using JSON.

## Cisco ISE ERS API

This online SDK is an application programming reference that explains the operations, parameters, and responses of the Cisco ISE ERS API. ERS is designed to allow external clients to perform CRUD operations on ISE resources, ERS is based on the HTTP protocol and REST methodology. Here, you will learn how to easily enable ERS and to start building your own applications. Note: The ERS is limited to Active Directory operations only for ISE-PIC nodes.

First, you need to enable ERS to start listening for API requests using Secure Sockets Layer (SSL) on port 9060. Clients trying to access this port without enabling ERS first will face a timeout from the server. Therefore, the first requirement is to enable ERS from the ISE admin user interface. Go to **Administration > Settings > ERS Settings**. Check the **Enable ERS for Read/Write** radio button.

The figure illustrates the use of the REST API to access a resource.

![alt text](/DevNet/DEVASC_200-901/Images/image-2373.png)

Refer to the documentation for the list of available resources given the version of Cisco ISE.

Multiple filters can be used and evaluated using an operator, and concatenated to the URL using the dot character:

- EQ: Equals
- NEQ: Not Equals
- GT: Greater Than
- LT: Less Then
- STARTW: Starts With
- NSTARTSW: Not Starts With
- ENDSW: Ends With
- NENDSW: Not Ends With
- CONTAINS: Contains
- NCONTAINS: Not Contains

Example:

`GET /ers/config/internaluser?filter=name.STARTW.a&filter=identityGroup.EQ.Finance`

## Cisco AMP Use Cases

Cisco AMP for Endpoints provides comprehensive protection against the most advanced attacks. It prevents breaches and blocks malware at the point of entry, then detects, contains, and remediates advanced threats that evade front-line defenses and get inside your network.

Cisco AMP results can be one of the following:

- **Prevent:** Strengthen defenses using global threat intelligence, and block both fileless and file-based malware in real time.
- **Detect:** Continuously monitor and record all file activity to detect malware.
- **Respond:** Accelerate investigations and automatically remediate malware across PCs, Macs, Linux, servers, and mobile devices (Android and iOS).

The following lists identify the main Cisco AMP API use cases.

**Ingest Events:**

- Store events in third-party tools
- Archive extended event history
- Correlate against other logs

**Search Environment:**

- Find where a file has been
- Determine if a file was executed
- Capture command-line arguments

**Basic Management:**

- Create groups
- Move computers
- Manage file lists

## Cisco AMP API

Cisco Threat Grid uses REST to provide programmable access.

![alt text](/DevNet/DEVASC_200-901/Images/image-2374.png)

There are many different actions that you can perform.

## Cisco AMP API Example: Domain Feeds

The figure illustrates how to retrieve a limited number of events.

![alt text](/DevNet/DEVASC_200-901/Images/image-2375.png)

The reply is provided using JSON.

## Cisco Threat Grid API Use Cases

Threat intelligence is evidence-based information about a threat that can help protect against it in some wayâ€”block it entirely, mitigate the risk, identify its perpetrator, or even just to detect it. In the context of cyberthreat intelligence, it is usually things like lists of indicators of compromise, or known bad actors, and so on.

Common use cases for threat intelligence include the following:

- **Prevention** (for example: Block known bad guy)
- **Detection** (for example: Wait, why is someone on the network talking to known bad guy?)
- **Response** (for example: Block known bad guy, and see what you need to clean up)
- **Identify** adversary tools, techniques, and procedures:
  - Tools (What does bad guy use?)
  - Techniques (How do they use it?)
  - Procedures (What does their higher-level operation look like?)
- **Attribution** (for example: Who is this bad guy?)

The following lists identify the main Threat Grid API use cases.

**Sample Analysis:**

- Submit files for analysis
- Parse results for indicators
- Take action in the environment

**Context and Enrichment:**

- Associate indicators with a malware family
- Link a payload delivery to a Word document
- Correlate host and network indicators

**Threat Hunting:**

- Find naming patterns in files or domains
- Map out infrastructure used in a campaign
- Collect command-line arguments used by malware

## Cisco Threat Grid API

Cisco Threat Grid uses REST to provide programmable access.

![alt text](/DevNet/DEVASC_200-901/Images/image-2376.png)

Threat Grid API call construction:

- Root: `https://panacea.threatgrid.com/api/`
- API version: "v2" or "v3"
- API endpoint (rest of path)
- Parameters (query string):
  - API key: from account details page
  - Other parameters as available and required

Threat Grid API responses are using the JSON format and options for curated feeds (CSV, Snort, STIX).

## Cisco Threat Grid Example: Domain Feeds

Indicator of compromise (IOC) feeds are lists of paths, artifact checksums, URLs, IPs, registry keys, and so on that have been associated with an IOC.

The figure illustrates how to retrieve the IOC feeds for domains providing the time range of interest.

![alt text](/DevNet/DEVASC_200-901/Images/image-2377.png)

### Content Review Question

What is the easiest way to learn the Cisco FTD REST API?

- [] Use the provided documentation, which details all REST methods and objects.
- [x] Use the provided REST explorer that is hosted on FTD and learn by doing.
- [] Use the try-and-fail method.
- [] Use numerous examples from the Internet.
- [] Use the examples provided with the device documentation.
